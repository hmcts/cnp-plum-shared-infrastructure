#!groovy
import groovy.json.JsonSlurper

@Library('Infrastructure') _

properties([
    parameters([
        string(name: 'PRODUCT_NAME', defaultValue: 'plum', description: ''),
        string(name: 'DEPLOYMENT_TARGETS', defaultValue: '', description: 'Comma-separateed list of deployment targets, leave empty for environment defaults'),
        string(name: 'ENVIRONMENT', defaultValue: 'sandbox', description: 'Suffix for resources created'),
        choice(name: 'SUBSCRIPTION', choices: 'sandbox\nnonprod\nprod', description: 'Azure subscriptions available to build in')
    ])
])


productName = params.PRODUCT_NAME
subscription = params.SUBSCRIPTION
environment = params.ENVIRONMENT
deploymentTargets = params.DEPLOYMENT_TARGETS

echo "Building '${productName}' in '${environment}' depoyment targets '${deploymentTargets}'"

withParameterizedInfraPipeline(productName, environment, subscription, deploymentTargets) {
}
